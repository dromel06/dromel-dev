---
import Image from "astro/components/Image.astro";
import imgImage4 from "../assets/imgs/escarabajo.png";
import iconRightArrow from "../assets/icons/right-icon.svg";
import imgCoamco from "../assets/imgs/coamco.png";
import imgRecital from "../assets/imgs/recital.png";
import imgConejos from "../assets/imgs/conejos.png";
import { languageList } from "../i18n/ui";
import { useTranslation } from "../i18n/utils";

const currentLang = Astro.currentLocale || "es";
const t = useTranslation(currentLang as keyof typeof languageList);

var projects = [
    {
        title: t("projects_project1_title"),
        image: imgCoamco,
        url: "https://coamco.com/",
        description: t("projects_project1_description"),
    },
    {
        title: t("projects_project2_title"),
        image: imgRecital,
        url: "https://clarinetes-cdla.site/",
        description: t("projects_project2_description"),
    },
    {
        title: t("projects_project3_title"),
        image: imgConejos,
        url: false,
        description: t("projects_project3_description"),
    },
];
---

<section class="w-full lg:w-max-6xl" id="projects">
    <!-- ServiceDiv -->
    <div
        class="flex flex-col-reverse items-center justify-center lg:items-stretch lg:flex-row lg:py-[300px] p-8"
    >
        <div
            class="grid grid-cols-1 lg:grid-cols-3 gap-4 bg-accent min-h-[208px] rounded-[25px] lg:rounded-r-none lg:mt-10 lg:w-6xl p-4 lg:px-12 -mt-1"
        >
            {
                projects.map((project) => (
                    <div class="lg:h-20 rounded-[25px] lg:top-42 w-full lg:-mt-4 drop-shadow-lg drop-shadow-secondary ">
                        <div class="relative lg:-mt-8 bg-secondary rounded-[25px] rounded-bl-none project-card-title p-2 shadow-secondary shadow-md flex flex-col items-center justify-between">
                            <p class="relative  rounded-[25px] w-full px-4 py-2 text-xl  z-10 text-accent text-shadow-zinc-950 ">
                                {project.title}
                            </p>
                            <div class="relative p-2" data-name="image 4">
                                <Image
                                    src={project.image}
                                    alt="Decoración"
                                    class=" rounded-[15px] shadow-lg"
                                />
                            </div>
                        </div>
                        <div class="relative bg-secondary rounded-b-[30px] w-5/6 lg:w-70 shadow-xs  p-3 flex items-top justify-between ">
                            <div class="relative rounded-[28px] lg:w-full px-2 z-10 text-claro">
                                <span
                                    class="text-sm p-0"
                                    set:html={project.description}
                                />
                            </div>
                            <div class="absolute -top-2 -right-10">
                                <div
                                    class={
                                        project.url === false
                                            ? "group bg-gray-400 text-claro p-1 rounded-[15px] transition duration-300 shadow-sm shadow-gray-600"
                                            : "group bg-primary text-claro p-1 rounded-[15px] transition duration-300 shadow-sm shadow-primary"
                                    }
                                >
                                    {project.url === false ? (
                                        <div
                                            class="flex items-center justify-center opacity-50 pointer-events-none p-1 group-hover:opacity-60"
                                            aria-disabled="true"
                                            title="Proyecto no disponible"
                                        >
                                            <Image
                                                src={iconRightArrow}
                                                alt="No disponible"
                                                class="w-8 h-8 opacity-70 transition-transform duration-200"
                                            />
                                        </div>
                                    ) : (
                                        <a
                                            href={
                                                typeof project.url === "string"
                                                    ? project.url
                                                    : undefined
                                            }
                                            class="flex items-center justify-center rounded-[12px] p-1 hover:bg-grayish focus:outline-none hover:ring-2 hover:ring-offset-2 hover:ring-secondary transform transition duration-200 group-hover:scale-105"
                                            aria-label={`Abrir ${project.title}`}
                                            target="_blank"
                                            rel="noopener noreferrer"
                                        >
                                            <Image
                                                src={iconRightArrow}
                                                alt={`Abrir ${project.title}`}
                                                class="w-8 h-8 transform transition-transform duration-200 group-hover:translate-x-1"
                                            />
                                        </a>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>
                ))
            }
        </div>

        <div
            class="relative bg-accent rounded-[25px] rounded-b-none lg:rounded-br-[25px] lg:rounded-bl-none py-2 projects-title -0"
        >
            <p
                class="font-normal leading-[normal] not-italic text-[32px] text-center text-darken w-[228px]"
            >
                {t("projects_title")}
            </p>
            <div class="relative h-content" data-name="image 4">
                <Image
                    src={imgImage4}
                    alt="Decoración"
                    class="w-30 lg:w-auto absolute -top-18 -end-20 lg:end-0 z-20 drop-shadow-darken drop-shadow-lg"
                />
            </div>
        </div>
    </div>
</section>

<style>
    .projects-title::after {
        content: "";
        position: absolute;
        width: 20px;
        height: 20px;
        left: -20px;
        top: 20px;
        border-radius: 0 0 25px 0;
        z-index: 2;
        box-shadow: 4px 4px 0px 4px var(--color-accent);
    }

    @media (max-width: 1024px) {
        .projects-title::before {
            content: "";
            position: absolute;
            width: 20px;
            height: 20px;
            right: -20px;
            bottom: 4px;
            border-radius: 0 0 0 25px;
            box-shadow: -4px 4px 0px 3px var(--color-accent);
        }
        .projects-title::after {
            left: auto;
            top: auto;
            left: -20px;
            bottom: 4px;
            border-radius: 0 0 25px 0;
            box-shadow: 4px 4px 0px 3px var(--color-accent);
        }
    }
</style>
